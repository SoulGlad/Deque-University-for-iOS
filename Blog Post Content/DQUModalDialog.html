<html>
	<head>
		<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
		<title>Modal Dialog</title>
	</head>
	<body>
		<a href = "index.html">BACK HOME</a>
		<h1>Modal Dialog</h1>
		<p>Modal Dialogs are "pop up" notifications that visually alert the user.  This includes error messages, warnings, and operations that require user input.  They usually appear after a user action.  To discuss accessibility issues with Modal Dialogs, let us first go through an example.</p>
		<h3>Modal Dialog Example</h3>
		<h4><i>Broken Version</i></h4>
		<img src = "Images/ModalDialogStartScreen.png" alt = "Image of an iOS app with an 'Information' header and a button that says 'Open a modal dialog.'">
		<p>Pictured above is a screenshot of the "Broken Version" of the Modal Dialog Demo from our <a href = "https://github.com/dequelabs/Deque-University-for-iOS">Deque University for iOS app</a>. In it, we demonstrate to users how broken Modal Dialogs can be when considering accessibility.  This is the start screen.  In this image, VoiceOver is focused on the "Open a modal dialog" button.  When we double tap this button, the screen changes to look like the following:</p>
		<img src = "Images/ModalDialogVoiceOver.png" alt = "Image of an open Modal Dialog in an iOS app with three buttons: 'E-mail us!', 'Visit our Website!', and 'Close.' VoiceOver's focus is on the 'Open a modal dialog' button.">
		<p>Notice how the VoiceOver focus is not quite aligned with the "Thank You" header of the Modal Dialog.  This is because VoiceOver is actually still focused on the "Open a Modal Dialog" button.  The fact that the user can still access elements behind the Modal Dialog is <i>bad</i>.  No indication is made when the Modal Dialog appears, so to a VoiceOver user, it seems as though it does not exist at all!  The only way to get to the Modal Dialog is if the user tabs through every single element on the page.  Only then will the focus go to it.  For important information, this is not at all optimal.  The VoiceOver user may continue to use the app without realizing that anything popped up.</p>
		<p>As a side note, this "broken version" was quite simple to make.  We used a custom subclass of UIView that gets added to the view controller when the "Open a modal dialog" button is pressed.  This subclass contains the Modal Dialog.  We do not recommend using this method to create a Modal Dialog.</p>   
		<h4><i>Fixed Version</i></h4>
		<img src = "Images/ModalDialogFixed.png" alt = "Image of an open Modal Dialog in an iOS app with three buttons: 'E-mail us!', 'Visit our Website!', and 'Close.'  VoiceOver's focus is on the 'Thank You' heading of the Modal Dialog.">
		<p>As the image above suggests, the fixed version actually looks just about the same as the broken version; however, it is implemented completely different.  To fix the broken version, we ended up just following what Apple suggests to do to create Modal Dialogs.  When the Modal Dialog now appears, a view controller with the Modal Dialog is presented onto the current view controller.  When any of the Modal Dialog buttons are pressed, the view controller is dismissed.  This automatically is very accessible.  As soon as the view controller appears, VoiceOver changes its focus to the new view controller.  As the picture suggests, the first element it focuses on with our Modal Dialog is the "Thank You" heading.  In addition, an extra sound effect is added when the <code>presentViewController</code> function is called to let the VoiceOver user know that the screen has changed.  The sound effect also occurs when the Modal Dialog is closed.  Furthermore, when the Modal Dialog has opened, the only accessible elements are the header, the description, and the three buttons.  VoiceOver users cannot leave that page until they dismiss the view controller.  The only accessibility feature we had to add was <code>UIAccessibilityPostNotification(UIAccessibilityLayoutChangedNotification, button);</code> to change VoiceOver's focus to the "Open a modal dialog" button when the Modal Dialog is closed.  Originally, when the user closed a Modal Dialog, VoiceOver would automatically focus on the back button, so we changed its focus to the Modal Dialog button to make sure that VoiceOver users came back to the same place they left off (for navigation purposes).</p>
		<p>We originally tried breaking the view controller implementation for our "broken version" - however, it was already very accessible and was very difficult to break.  This means that using this method is solid and is highly recommended to use for accessibility purposes.</p>
		<h3>Creating an Accessible Modal Dialog</h3>
		<p>The best way to create an accessible Modal Dialog is to create the Modal Dialog in a separate view controller and add it into the current view controller with the following code:
<blockquote><pre class = "prettyprint"><code>UIViewController* modalDialogViewController = [[UIStoryboard storyboardWithName:@"Main" bundle:[NSBundle mainBundle]]
	instantiateViewControllerWithIdentifier:@"AccessibleModal"];
modalDialogViewController.modalPresentationStyle = UIModalPresentationOverCurrentContext;
[self.view presentViewController:modalDialogViewController animated:YES completion:nil];</code></pre></blockquote>
		Make sure to change the Storyboard ID in the Modal's view controller to "AccessibleModal" (without quotes).  This can be found in the Identity Inspector of the view controller in the "Identity" section.  In addition, there are multiple types of modal presentation styles; a full list can be found <a href = "https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/#//apple_ref/c/tdef/UIModalPresentationStyle">here</a>.</p>
		<p>To remove the Modal Dialog, simply use
		<blockquote><pre class = "prettyprint"><code>[self dismissViewController animation = YES completion = nil];</code></pre></blockquote>
		Then, to change VoiceOver's focus back to the original button, use
		<blockquote><pre class = "prettyprint"><code>UIAccessibilityPostNotification(UIAccessibilityLayoutChangedNotification, button);</code></pre></blockquote>
		More about this function can be found under Implementing Dynamic Notifications in <a href = "DQUDynamicNotifications.html">this blog post</a>.</p>
		<p>And that's it!  Thank you for reading; we hope you found this tutorial helpful!  To learn more about accessibility, visit our other <a href = "index.html">blog posts</a> and download our <a href = "https://github.com/dequelabs/Deque-University-for-iOS">Deque University for iOS app</a>, available on the App Store and in Github.</p>
	</body>
</html>
